<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>jQuery.parseXML demo</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fast-xml-parser/2.9.2/parser.min.js"></script>
</head>

<body>
  <?xml version="1.0" encoding="UTF-8" ?>
  <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name="shiporder">
      <xs:complexType>
        <xs:sequence>
          <xs:element name="orderperson" type="xs:string" />
          <xs:element name="shipto">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="name" type="xs:string" />
                <xs:element name="address" type="xs:string" />
                <xs:element name="city" type="xs:string" />
                <xs:element name="country" type="xs:string" />
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element name="item" maxOccurs="unbounded">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="title" type="xs:string" />
                <xs:element name="note" type="xs:string" minOccurs="0" />
                <xs:element name="quantity" type="xs:positiveInteger" />
                <xs:element name="price" type="xs:decimal" />
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="orderid" type="xs:string" use="required" />
      </xs:complexType>
    </xs:element>

  </xs:schema>

  <p id="demo"></p>

  <script>
    var xml = `<?xml version="1.0" encoding="UTF-8" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

<xs:element name="shiporder">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="orderperson" type="xs:string"/>
      <xs:element name="shipto">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="name" type="xs:string"/>
            <xs:element name="address" type="xs:string"/>
            <xs:element name="city" type="xs:string"/>
             <xs:element name="country" type="xs:string"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="item" maxOccurs="unbounded">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="title" type="xs:string"/>
            <xs:element name="note" type="xs:string" minOccurs="0"/>
            <xs:element name="quantity" type="xs:positiveInteger"/>
            <xs:element name="price" type="xs:decimal"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="orderid" type="xs:string" use="required"/>
  </xs:complexType>
</xs:element>

</xs:schema>
`;


    var xml2 = `<?xml version="1.0" encoding="UTF-8"?>
<xs:schema targetNamespace="http://tethys.sdsu.edu/schema/1.0" elementFormDefault="unqualified"
    xmlns="http://tethys.sdsu.edu/schema/1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:include schemaLocation="CommonElements.xsd"/>

    <xs:element name="Event">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="Name" type="xs:string">
                    <xs:annotation>
                        <xs:documentation>Name of event</xs:documentation>
                    </xs:annotation>
                </xs:element>
                <xs:element name="Description">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="Type" type="xs:string">
                                <xs:annotation>
                                    <xs:documentation>Short description of event type, e.g. pile driving</xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:element minOccurs="0" name="Info" type="xs:string">
                                <xs:annotation>
                                    <xs:documentation>Textual description of event.</xs:documentation>
                                </xs:annotation>
                            </xs:element>
                            <xs:group ref="ContactGroup"/>
                        </xs:sequence>
                    </xs:complexType>
                </xs:element>
                <xs:element name="Start" type="xs:dateTime"/>
                <xs:element name="End" type="xs:dateTime"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema>`;






    function xmlFunc(xml) {
      var parser = new DOMParser();
      var xmlDoc = parser.parseFromString(xml, "text/xml")
      var x = xmlDoc.documentElement.childNodes;
      for (var i = 0; i < x.length; i++) {
        if (x[i].nodeValue == undefined || x[i].nodeValue == null) {
          console.log(x[i].getAttribute("name"));
          console.log(x[i].getAttributeNode("name").nodeValue);
        } else {
          continue;
        }
      }
    }

    //xmlFunc(xml);


    function jquery(xml) {
      var xmlDoc = $.parseXML(xml);
      var name = $(xmlDoc).find('xs:element');
      console.log("name: ", name);
      console.log("all8: ", document.all[8]);
      console.log("all10: ", document.all[10]);
      console.log("all10: ", document.all[10].getAttribute("name"));
    }
    // jquery(xml);






    function working(xml) {
      var xmlDoc = $.parseXML(xml);
      var name = $(xmlDoc).find('xs:element');

      for (var i = 0; i < document.all.length; i++) {

        //      if(document.all[i].getAttribute("name") != null ) {
        //        if(document.all[i-1].getAttribute("name") == null){
        //          console.log("    ");
        //        }
        console.log(document.all[i].getAttribute("name"));
        // }
      }
    }
    //working(xml);
    //console.log(document.all[8]);








    //iterates through the dom depth first method
    function iterateDOMTree(node) {
      console.log("node: ", node);
      // console.log("node.attributes: ", node.attributes);
      // console.log("node.Experiment: ", node.attrib);
      //console.log("--------------");
      //console.log(i + ": ", node.getAttribute("name"));

      for (node = node.firstElementChild; node != null; node = node.nextElementSibling) {
        iterateDOMTree(node);
      }
    }
    var xmlDoc = $.parseXML(xml);
    // iterateDOMTree(xmlDoc);

    //displaying the XML to see it visually
    console.log(xml);
    //parsed XML DOM
    console.log(xmlDoc);
    //Print the first layer(BFS method) of xmlDoc
    var firstChildren = $(xmlDoc).children();
    console.log(firstChildren);


    // trying to traverse a three with bredth first method (this will enter each simbling before going into depth)
    function BFSiteration(node) {

      var queue = [];

      queue.push(node);


      currentTree = queue.shift();
      //var i = 0;
      //var length = currentTree.children.length;
      while (currentTree) {

        for (var i = 0; i < currentTree.children.length; i++) {

          var final = currentTree.children[i];
          queue.push(final);
          if (currentTree.nodeType == 1 && final.hasAttributes("name")) {
            if (i == 0)
              console.log("---")
            console.log(final.getAttribute("name"));
            //////////////////////////////////////////////////
            /////////////////////////////////////////////////
            //cannot find the parent of the first element because it doesnt exist we need to skip the first element
            if (final.parentElement.hasAttribute("name")) {
              print("     ", final.parentElement.getAttribute("name"));
            } else if (final.parentElement.parentElement.hasAttribute("name")) {
              print("     ", final.parentElement.parentElement.getAttribute('name'));
            } else if (final.parentElement.parentElement.parentElement.hasAttribute("name")) {
              print("     ", final.parentElement.parentElement.parentElement.getAttribute('name'));
            }
            //////////////////////////////////////////////////
            //////////////////////////////////////////////////
          }
        }
        currentTree = queue.shift();
      }
    }


    console.log("------------");
    BFSiteration(xmlDoc);



    //bfs explanation
    //https://code.tutsplus.com/articles/data-structures-with-javascript-tree--cms-23393






    ////////////////////////////////////////////////////////////////////////
    //We can only get the attribute from an array this is an example of it.
    // var element = xmlDoc.getElementsByTagName("xs:element");
    //console.log(element[1].getAttribute("name"));
    /////////////////////////////////////////////////////////////////////////





    //  
    //  var jsObj = parser.parse(xml,{attrPrefix:"",ignoreTextNodeAttr: false});
    //  document.write(JSON.stringify(jsObj.xml["xs:sequence"]["xs:element"],null,4) + "<br>");
    ////document.write(JSON.stringify(jsObj.xml["rs:data"]["z:row"][1],null,4) + "<br>");
    ////document.write(JSON.stringify(jsObj.xml["rs:data"]["z:row"][2],null,4) + "<br>");
    ////  
    //  








    //using Xpath inside JavaScript
    //var xpathResult = document.evaluate(
    // "html/body//element", 
    // document, 
    // null, 
    // XPathResult.ANY_TYPE, 
    // null
    //);
    //  
    //var thisHeading = headings.iterateNext(); 
    //var alertText = "Level 2 headings in this document are:\n";
    //while (thisHeading) {
    //  alertText += thisHeading.textContent + "\n";
    //  thisHeading = headings.iterateNext();
    //}
    //alert(alertText);
    //

  </script>


</body>

</html>
