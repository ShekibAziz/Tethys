<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <title>Tethys</title>
  <style>
    html,
    body {
      height: 100%;
      width: 100%;
    }

    #title {
      color: white;
    }

    #treeStructureBox {
      margin: auto;
      width: 99%;
      height: 70%;
      margin-bottom: 10px;
    }

    #queryRefinerBox {
      margin: auto;
      width: 99%;
      height: 18%;
    }

    iframe {
      border: none;
      width: 100%;
      height: 90%;
    }

  </style>
</head>

<body>
  <!--     Main Navbar-->
  <nav class="navbar navbar-dark bg-primary justify-content-between">
    <a id="title" class="navbar-brand">Hello I'm Tethys</a>
  </nav>

  <!--Second Small navbar Page.(Schema tree structure)(show all collapse all search)   -->
  <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div class="dropdown">
      <button class="btn btn-info btn-outline-primary btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">XML Schemas</button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#">Calibrations</a>
        <a class="dropdown-item" href="#">Common Elements</a>
        <a class="dropdown-item" href="#">Deployment</a>
        <a class="dropdown-item" href="#">Detections.v1_2</a>
        <a class="dropdown-item" href="#">Detections</a>
        <a class="dropdown-item" href="#">Ensemble</a>
        <a class="dropdown-item" href="#">Events</a>
        <a class="dropdown-item" href="#">Itis</a>
        <a class="dropdown-item" href="#">Localization</a>
        <a class="dropdown-item" href="#">New Deployment</a>
        <a class="dropdown-item" href="#">Species Abbreviations</a>
        <a class="dropdown-item" href="#">Tethys</a>
        <a class="dropdown-item" href="#">Tethys Schema Project</a>
        <a class="dropdown-item" href="#">Transfer Function</a>
      </div>
    </div>
    <div class="">


      <form class="form-inline justify-content-end">
        <button type="button" class="mr-sm-1 btn btn-sm btn-dark">Show All</button>
        <button type="button" class="mr-sm-1 btn btn-sm btn-dark">Collapse All</button>
        <input class="form-control btn-sm mr-sm-1" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-sm btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div>
  </nav>


  <!--  Space for the Tree structure -->
  <!--
<div id="treeStructureBox" class="border border-primary">
  <h3>I'm a future Tree</h3>
  <iframe height="300px" width="100%" src="http://xmlgrid.net/view/xsdViewer.html"></iframe>
</div>
-->

  <!-- Space for the query refiner   -->
  <div id="queryRefinerBox" class="border border-primary">
    <h3>I'm a Query Refiner</h3>
  </div>

  <div id="info">
    <h1>his</h1>
  </div>


  <script>
    //Keeps the selected XML schema as the selected dropdown option 
    $(function() {

      $(".dropdown-menu a").click(function() {

        $(".btn:first-child").text($(this).text());
        $(".btn:first-child").val($(this).text());

      });
    });
    //?????????????????????????????????????????????????????????????????????????????????????????????Not working
    // Load only a selected section of a page
    $(document).ready(function() {
      console.log("----------------------------hello 1----------------------------");
      $('#info').load('http://xmlgrid.net #section1');
      console.log("++++++++++++++++++++++++++++hello 2++++++++++++++++++++++++++++");
    });
    //?????????????????????????????????????????????????????????????????????????????????????????????Not working 



    //        var url = "http://localhost:9779/XQuery";
    //        var dataKey = 'XQuery';
    //        var dataValue = `(: import Tethys schema so we have type information about the docuements :)
    //import schema namespace ty="http://tethys.sdsu.edu/schema/1.0" at "tethys.xsd";
    //(: import utility functions :)
    //import module namespace lib="http://tethys.sdsu.edu/XQueryFns" at "Tethys.xq";
    //
    //
    //let $xmldocument := 0  (: first document :)
    //let $xmldocs := ()     (: no documents so far :)
    //
    //(: Find all of the desired detections.  
    //   This query is a bit more complicated than it need by as we are tracking
    //   which XML document the detections came from.  
    //
    //   This is sometimes useful, especially when there are multiple lines
    //   of effort across the same time and space, although it is not really 
    //   needed here.
    //
    //   We create a temporary variable with all of the detections and then sort them
    //   in the next query.  Again, this is overengineering for this specific query,
    //   but would be needed to return detections from multiple deployments in order.
    //:)
    //let $detections := for $item in (
    //    for $det at $p in collection("Detections")/ty:Detections
    //        let $xmldocument := $xmldocument + 1
    //        let $xmldocs := ($xmldocs, $det/DataSource)
    //        (: conditions on Detections group :)
    //        where upper-case($det/DataSource/Site) = upper-case("M") and 
    //              upper-case($det/DataSource/Project) = upper-case("SOCAL") and
    //              $det/DataSource/Deployment = 38.000000 
    //        return
    //           for $detection in $det/OnEffort/Detection  (: OnEffort/OffEffort :)
    //              (: conditions on individual Detections, here we use
    //                 an abbreviation for the species name  :)
    //              where $detection/SpeciesID = lib:abbrev2tsn("Zc", "NOAA.NMFS.v1") 
    //           return
    //                <Detection>
    //                  {$detection/Start}
    //                  {$detection/End}
    //                  <idx>{xs:integer($p)}</idx>
    //                </Detection>
    //        )
    //  return $item
    //
    //(: Sources contains the list of indices corresponding to all of the documents
    //   from which we drew detections :)
    //let $sources := distinct-values(for $d in $detections return $d/idx)
    //
    //(: Finally, we return the detections and a lsit of the data sources
    //   from which they came. :)
    //
    //return
    //<ty:Result xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    //<Detections>
    //  {(: Rewrite the detections mapping each detection to a deployment/ensemble :)
    //   for $d in $detections
    //   order by $d/Start
    //   return
    //     <Detection>
    //      {$d/Start}
    //      {$d/End}
    //      <idx>{index-of(($sources), $d/idx)}</idx>
    //     </Detection>
    //  }
    //</Detections>
    //<Sources>
    //  {
    //   (: Write out the information for the deployment/ensembles :)
    //   for $source in $sources
    //     return
    //      collection("Detections")[xs:decimal($source)]/ty:Detections/DataSource
    //  }
    //</Sources>
    //</ty:Result>`;
    //
    //
    //
    //
    //        var data = {"XQuery":dataValue};
    //        $.post(url, data, function(data){
    //            console.log(data);
    //          $('#info').html(data);  
    //        })

  </script>


</body>

</html>
