<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <title>Tethys</title>
  <style>
    html,
    body {
      height: 100%;
      width: 100%;
    }

    #title {
      color: white;
    }

    #treeStructureBox {
      margin: auto;
      width: 99%;
      height: 70%;
      margin-bottom: 10px;
    }

    #queryRefinerBox {
      margin: auto;
      width: 99%;
      height: 18%;
    }

    iframe {
      border: none;
      width: 100%;
      height: 90%;
    }

    svg {
      border: 1px solid silver;
    }

    .node {
      cursor: pointer;
    }

    .node circle {
      stroke: steelblue;
      stroke-width: 1.5px;
    }

    .link {
      fill: none;
      stroke: lightgray;
      stroke-width: 1.5px;
    }

    #treeStructureBox {
      font-size: 10.5px;
    }

  </style>
</head>

<body>
  <!--     Main Navbar-->
  <nav class="navbar navbar-dark bg-primary justify-content-between">
    <a id="title" class="navbar-brand">Hello I'm Tethys</a>
  </nav>

  <!--Second Small navbar Page.(Schema tree structure)(show all collapse all search)   -->
  <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div class="dropdown">
      <select id="schemaSelector" class="btn btn-info btn-outline-primary btn-sm custom-select">
        <option value="0">Select a Schema</option>
        <option value="1">Calibrations</option>
        <option value="2">Deployment</option>
        <option value="3">Detections.v1_2</option>
        <option value="4">Detections</option>
        <option value="5">Ensemble</option>
        <option value="6">Events</option>
        <option value="7">Itis</option>
        <option value="8">Localization</option>
        <option value="9">New Deployment</option>
        <option value="10">Species Abbreviations</option>
        <option value="11">Tethys</option>
        <option value="12">Tethys Schema Project</option>
        <option value="13">Transfer Function</option>
      </select>
    </div>

    <!--    form-->

    <div class="">


      <form class="form-inline justify-content-end">
        <button id="showAll" type="button" class="mr-sm-1 btn btn-sm btn-dark">Show All</button>
        <button type="button" class="mr-sm-1 btn btn-sm btn-dark">Collapse All</button>
        <input class="form-control btn-sm mr-sm-1" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-sm btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div>
  </nav>


  <!--  Space for the Tree structure -->

  <div id="treeStructureBox" class="border border-primary">
    <h3>Please Select a Schema</h3>
  </div>

  <!-- Space for the query refiner   -->
  <div id="queryRefinerBox" class="border border-primary">
    <h3>I'm a Query Refiner</h3>
  </div>

  <div id="info">
    <h1>his</h1>
  </div>


  <script>
    $(document).ready(function() {
      console.log("Im Jquery and Im working");


      //onChange of schena selecter update the tree
      //??????????????????????????????????????????????????????????????
      $('#schemaSelector').on('change', function() {
        var selectedVal = $(this).val();
        if (selectedVal == 0) {
          $('#treeStructureBox').html("<h3>Please Select a Schema</h3>");
          console.log("0");
        } else if (selectedVal == 1) {
          $('#treeStructureBox').html("");
          console.log("1");
          something("1");
        } else if (selectedVal == 2) {
          $('#treeStructureBox').html("");
          console.log("2");
          something("2");
        } else if (selectedVal == 3) {
          $('#treeStructureBox').html("");
          console.log("3");
          something("3");
        } else {
          $('#treeStructureBox').html("");
          console.log("You hit the else statements");
          $('#treeStructureBox').html("<h3>Else statement</h3>");
        }

        //??????????????????????????????????????????????????????????????



      });


      //D3 begins
      function something(Value) {
        var json1 = {
          "name": "ShipOrder",
          "children": [{
              "name": "Orderperson",
              "type": "xs:string",
            },
            {
              "name": "Shipto",
              "children": [{
                "name": "name",
                "type": "xs:string"
              }, {
                "name": "Shipto",
                "children": [{
                  "name": "name",
                  "type": "xs:string"
                }, {
                  "name": "Shipto",
                  "children": [{
                    "name": "name",
                    "type": "xs:string"
                  }, {
                    "name": "address",
                    "type": "xs:string"
                  }, {
                    "name": "city",
                    "type": "xs:string"
                  }, {
                    "name": "Shipto",
                    "children": [{
                      "name": "name",
                      "type": "xs:string"
                    }, {
                      "name": "address",
                      "type": "xs:string"
                    }, {
                      "name": "city",
                      "type": "xs:string"
                    }, {
                      "name": "country",
                      "type": "xs:string"
                    }, ]
                  }, {
                    "name": "country",
                    "type": "xs:string"
                  }, ]
                }, {
                  "name": "address",
                  "type": "xs:string"
                }, {
                  "name": "city",
                  "type": "xs:string"
                }, {
                  "name": "country",
                  "type": "xs:string"
                }, ]
              }, {
                "name": "address",
                "type": "xs:string"
              }, {
                "name": "city",
                "type": "xs:string"
              }, {
                "name": "country",
                "type": "xs:string"
              }, ]
            },
            {
              "name": "item",
              "children": [{
                "name": "title",
                "type": "xs:string"
              }, {
                "name": "note",
                "type": "xs:string"
              }, {
                "name": "quanityt",
                "type": "xs:positiveInteger"
              }, {
                "name": "price",
                "type": "xs:decimal"
              }, ]
            },
            {
              "name": "orderid",
              "type": "xs:string"
            }
          ]
        };
        var deployment = {
          "name": "Deployment",
          "children": [{
              "name": "Common Elements",
              "children": [{
                  "name": "Description Type",
                  "comment": "Text based description of process",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Objectives",
                      "type": "string",
                      "comment": "What are the objectives of this effort?  Examples: Beamform to increase SNR for detection. Detect every click of a rare species. Verify data quality."
                    }, {
                      "name": "Abstract",
                      "type": "string",
                      "comment": "Overview of effort"
                    }, {
                      "name": "Method",
                      "type": "string",
                      "comment": "High-level description of the method used"
                    }]
                  }]

                }, {
                  "name": "Data Source Type",
                  "comment": "Indicates the deployment or ensemble from which the process (e.g detector) derived information",
                  "children": [{
                    "name": "choice",
                    "children": [{
                      "name": "Ensemble Name",
                      "comment": "Name of a group of instruments being used together for a common purpose (e.g. large aperture array).  The Name will correspond to an instance in the Ensemble collection.",
                      type: "string"
                    }, {
                      "name": "Sequence",
                      comment: "Information that identifies a specific deployment within the Deployment collection.",
                      "children": [{
                        "name": "Project",
                        "type": "string"
                      }, {
                        "name": "Deployment",
                        "type": "integer"
                      }, {
                        "name": "Choice",
                        "children": [{
                          "name": "Site",
                          "type": "string"
                        }, {
                          "name": "Cruise",
                          "type": "string"
                        }]
                      }]
                    }]
                  }, ]
                }, {
                  "name": "Algorithm Type",
                  "comment": "Description of detection algorithm",
                  "children": [{
                    "name": "Method",
                    "comment": "Text based description of algorithm or citation",
                    "type": "string"

                  }, {
                    "name": "Software",
                    "comment": "Name of software that implements the algorithm.  This might be the name of a plug-in or extension module that is part of a larger program or system.",
                    "type": "string"
                  }, {
                    "name": "Version",
                    "type": "string",
                    "comment": "Software version identifier"
                  }, {
                    "name": "Parameters",
                    "comment": "Structured tags to describe parameters used in algorithm execution.",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "##any"
                      }]
                    }]
                  }, {
                    "name": "Support Software",
                    "comment": "Software required in addition to the algorithm itself, e.g. Matlab, Ishmael, XBAT, Triton, etc.",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Software",
                        "type": "string"
                      }, {
                        "name": "Version",
                        "type": "string"
                      }, {
                        "name": "Parameters",
                        "comment": "Structured tags to describe parameters used in algorithm execution.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "##any"
                          }]
                        }]
                      }]

                    }]
                  }]
                }, {
                  "name": "Quality Assurance Process Type",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Description",
                      "children": [{
                        "name": "Sequence",
                        "comment": "Text based description of process.",
                        "children": [{
                          "name": "Objectives",
                          "type": "string",
                          "comment": "What are the objectives of this effort?  Examples: Beamform to increase SNR for detection. Detect every click of a rare species. Verify data quality.",
                        }, {
                          "name": "Abstract",
                          "type": "string",
                          "comment": "Overview of effort.",
                        }, {
                          "name": "Method",
                          "type": "string",
                          "comment": "High-level description of the method used.",
                        }]
                      }]
                    }, {
                      "name": "Responsible Party",
                      "comment": "based on ISO 19115",
                      "children": [{
                        "name": "Attributes",
                        "children": [{
                          "name": "id",
                          "type": "NCName",
                          "comment": "Handle to external database"
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                          "name": "Individual Name",
                          "type": "string"
                        }, {
                          "name": "Organization Name",
                          "type": "string"
                        }, {
                          "name": "Position Name",
                          "type": "string"
                        }, {
                          "name": "Contact Info",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Phone",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Voice",
                                  "type": "string"
                                }, {
                                  "name": "Facsimile",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Address",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Delivery Point",
                                  "type": "string"
                                }, {
                                  "name": "City",
                                  "type": "string"
                                }, {
                                  "name": "Administrative Area",
                                  "type": "string"
                                }, {
                                  "name": "Postal Code",
                                  "type": "string"
                                }, {
                                  "name": "Country",
                                  "type": "string"
                                }, {
                                  "name": "Electronic Mail Address",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Online Resource",
                              "comment": "We do not fully conform to the onlineResources of ISO 19115",
                              "children": [{
                                "name": "Attributes",
                                "children": [{
                                  "name": "##Any"
                                }]
                              }]
                            }, {
                              "name": "Hours of Service",
                              "type": "string"
                            }, {
                              "name": "Contact Instructions",
                              "type": "string"
                            }]
                          }]
                        }]
                      }]

                    }]
                  }]
                }, {
                  "name": "Contact Group",
                  "comment": "Contains a subset of the OpenGIS SensorML ContactGroup (http: //www.opengis.net/sensorML/1.0).  Parsing the full SensorML schema will slow down processing.",
                  "children": [{
                    "name": "Choice",
                    "children": [{
                      "name": "Person",
                      "children": [{
                        "name": "Attributes",
                        "children": [{
                          "name": "id",
                          "comment": "Handle to external database",
                          "type": "NCName"
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                          "name": "Surname",
                          "type": "token"
                        }, {
                          "name": "Name",
                          "type": "token"
                        }, {
                          "name": "UserID",
                          "type": "token"
                        }, {
                          "name": "Affiliation",
                          "type": "token"
                        }, {
                          "name": "Phone Number",
                          "type": "token"
                        }, {
                          "name": "Email",
                          "type": "token"
                        }]
                      }]
                    }, {
                      "name": "Responsible Party",
                      "comment": "based on ISO 19115",
                      "children": [{
                        "name": "Attribute",
                        "children": [{
                          "name": "id",
                          "comment": "Handle to external database",
                          "type": "NCName"
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                            "name": "Individual Name",
                            "type": "string"
                          }, {
                            "name": "Organization Name",
                            "type": "string"
                          }, {
                            "name": "Position Name",
                            "type": "string"
                          },
                          {
                            "name": "Contact Info",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Phone",
                                "children": [{
                                  "name": "Sequence",
                                  "children": [{
                                    "name": "Voice",
                                    "type": "string"
                                  }, {
                                    "name": "Facsimile",
                                    "type": "string"
                                  }]
                                }]
                              }, {
                                "name": "Address",
                                "children": [{
                                  "name": "Sequence",
                                  "children": [{
                                    "name": "Delivery Point",
                                    "type": "string"
                                  }, {
                                    "name": "City",
                                    "type": "string"
                                  }, {
                                    "name": "Administrative Area",
                                    "type": "string"
                                  }, {
                                    "name": "Postal Code",
                                    "type": "string"
                                  }, {
                                    "name": "Country",
                                    "type": "string"
                                  }, {
                                    "name": "Electronic Mail Address",
                                    "type": "string"
                                  }]
                                }]
                              }, {
                                "name": "Online Resource",
                                "comment": "We do not fully conform to the onlineResources of ISO 19115",
                                "children": [{
                                  "name": "Attributes",
                                  "children": [{
                                    "name": "##Any"
                                  }]
                                }]
                              }, {
                                "name": "Hours of Service",
                                "type": "string"
                              }, {
                                "name": "Contact Instructions",
                                "type": "string"
                              }]
                            }]

                          }
                        ]
                      }]
                    }]
                  }]
                }, {
                  "name": "Person",
                  "children": [{
                    "name": "Attributes",
                    "children": [{
                      "name": "id",
                      "comment": "Handle to external database",
                      "type": "NCName"
                    }]
                  }, {
                    "name": "Sequence",
                    "children": [{
                      "name": "Surname",
                      "type": "token"
                    }, {
                      "name": "Name",
                      "type": "token"
                    }, {
                      "name": "UserID",
                      "type": "token"
                    }, {
                      "name": "Affiliation",
                      "type": "token"
                    }, {
                      "name": "Phone Number",
                      "type": "token"
                    }, {
                      "name": "Email",
                      "type": "token"
                    }]
                  }]
                },
                {
                  "name": "Responsible Party",
                  "comment": "based on ISO 19115",
                  "children": [{
                    "name": "Attributes",
                    "children": [{
                      "name": "id",
                      "type": "NCName",
                      "comment": "Handle to external database"
                    }]
                  }, {
                    "name": "Sequence",
                    "children": [{
                      "name": "Individual Name",
                      "type": "string"
                    }, {
                      "name": "Organization Name",
                      "type": "string"
                    }, {
                      "name": "Position Name",
                      "type": "string"
                    }, {
                      "name": "Contact Info",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Phone",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Voice",
                              "type": "string"
                            }, {
                              "name": "Facsimile",
                              "type": "string"
                            }]
                          }]
                        }, {
                          "name": "Address",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Delivery Point",
                              "type": "string"
                            }, {
                              "name": "City",
                              "type": "string"
                            }, {
                              "name": "Administrative Area",
                              "type": "string"
                            }, {
                              "name": "Postal Code",
                              "type": "string"
                            }, {
                              "name": "Country",
                              "type": "string"
                            }, {
                              "name": "Electronic Mail Address",
                              "type": "string"
                            }]
                          }]
                        }, {
                          "name": "Online Resource",
                          "comment": "We do not fully conform to the onlineResources of ISO 19115",
                          "children": [{
                            "name": "Attributes",
                            "children": [{
                              "name": "##Any"
                            }]
                          }]
                        }, {
                          "name": "Hours of Service",
                          "type": "string"
                        }, {
                          "name": "Contact Instructions",
                          "type": "string"
                        }]
                      }]
                    }]
                  }]

                },
                {
                  "name": "Contact Info",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Phone",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Voice",
                          "type": "string"
                        }, {
                          "name": "Facsimile",
                          "type": "string"
                        }]
                      }]
                    }, {
                      "name": "Address",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Delivery Point",
                          "type": "string"
                        }, {
                          "name": "City",
                          "type": "string"
                        }, {
                          "name": "Administrative Area",
                          "type": "string"
                        }, {
                          "name": "Postal Code",
                          "type": "string"
                        }, {
                          "name": "Country",
                          "type": "string"
                        }, {
                          "name": "Electronic Mail Address",
                          "type": "string"
                        }]
                      }]
                    }, {
                      "name": "Online Resource",
                      "comment": "We do not fully conform to the onlineResources of ISO 19115",
                      "children": [{
                        "name": "Attributes",
                        "children": [{
                          "name": "##Any"
                        }]
                      }]
                    }, {
                      "name": "Hours of Service",
                      "type": "string"
                    }, {
                      "name": "Contact Instructions",
                      "type": "string"
                    }]
                  }]
                },
                {
                  "name": "Long Lat",
                  "comment": "Spherical reference system",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Longitude",
                      "type": "double",
                      "comment": "Expressed in degrees East [0, 360)"
                    }, {
                      "name": "Latitude",
                      "type": "double",
                      "comment": "Expressed in degrees North [-90, 90]"
                    }]
                  }]
                },
                {
                  "name": "Long Lat3",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Longitude",
                      "type": "double",
                      "comment": "Expressed in degrees East [0, 360)"
                    }, {
                      "name": "Latitude",
                      "type": "double",
                      "comment": "Expressed in degrees North [-90, 90]"
                    }, {
                      "name": "Altitude_m",
                      "type": "double",
                      "comment": "Optional altitude (negative for depth) in meters"
                    }]
                  }]
                },
                {
                  "name": "SpeciesID Type",
                  "comment": "Integrated Taxonomic Information System species identifier http://www.itis.gov/ for positive numbers.Negative numbers are interpreted by collection('phenomena').",
                  "type": "string",
                  "children": [{
                    "name": "Attributes",
                    "children": [{
                      "name": "Group",
                      "type": "string"
                    }]
                  }]
                },
                {
                  "name": "Call Type",
                  "comment": "Description of a call",
                  "type": "string",
                  "children": [{
                    "name": "Attributes",
                    "children": [{
                      "name": "SybType",
                      "type": "string"
                    }]
                  }]
                },
                {
                  "name": "Event Type",
                  "comment": "Event identifier.  Optional tag typically in ISO datetime format YYYY-MM-DDTHH:MM:SSZ identifying this event uniquely within the stream (detections, localizations, etc.).For human analysts,it is typical to use the time at which the detection was made.When used, the combination of the event and attributes that uniquely identify the set of detections(or document name) must be unique.",
                  "type": "string"
                },
                {
                  "name": "Bearing Deg",
                  "type": "double"
                },
                {
                  "name": "MetaData Info",
                  "comment": "Information about who is responsible for this metadata record, when it was created, and how often it is updated.",
                  "children": [{
                    "name": "Sequences",
                    "children": [{
                      "name": "Responsible Party",
                      "comment": "based on ISO 19115",
                      "children": [{
                        "name": "Attributes",
                        "children": [{
                          "name": "id",
                          "type": "NCName",
                          "comment": "Handle to external database"
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                          "name": "Individual Name",
                          "type": "string"
                        }, {
                          "name": "Organization Name",
                          "type": "string"
                        }, {
                          "name": "Position Name",
                          "type": "string"
                        }, {
                          "name": "Contact Info",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Phone",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Voice",
                                  "type": "string"
                                }, {
                                  "name": "Facsimile",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Address",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Delivery Point",
                                  "type": "string"
                                }, {
                                  "name": "City",
                                  "type": "string"
                                }, {
                                  "name": "Administrative Area",
                                  "type": "string"
                                }, {
                                  "name": "Postal Code",
                                  "type": "string"
                                }, {
                                  "name": "Country",
                                  "type": "string"
                                }, {
                                  "name": "Electronic Mail Address",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Online Resource",
                              "comment": "We do not fully conform to the onlineResources of ISO 19115",
                              "children": [{
                                "name": "Attributes",
                                "children": [{
                                  "name": "##Any"
                                }]
                              }]
                            }, {
                              "name": "Hours of Service",
                              "type": "string"
                            }, {
                              "name": "Contact Instructions",
                              "type": "string"
                            }]
                          }]
                        }]
                      }]

                    }, {
                      "name": "Date",
                      "type": "dateTime"
                    }, {
                      "name": "Update Frequency",
                      "type": "string"
                    }]
                  }]
                }
              ]
            },
            {
              "name": "Deployment",
              "children": [{
                "name": "Sequence",
                "children": [{
                  "name": "Project",
                  "type": "string",
                  "comment": "Name of project associated with this deployment.  Can be related to a geographic region, funding source, etc."
                }, {
                  "name": "DeploymentID",
                  "type": "int",
                  "comment": "Deployment identifier, a number related to either the Nth deployment operation in a series of deployments or the Nth deployment at a specific site."
                }, {
                  "name": "Deployment Alias",
                  "type": "string",
                  "comment": "Alternative deployment description."
                }, {
                  "name": "Choice",
                  "comment": "Deployment must be associated with a site or a cruise",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Site",
                      "type": "string",
                      "comment": "Name for current location"
                    }, {
                      "name": "Cruise",
                      "type": "string",
                      "comment": "Name og deployment cruise"
                    }, {
                      "name": "Site Aliases",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Site",
                          "type": "string"
                        }]
                      }],
                      "comment": "Alternative names for the deployment location"
                    }]
                  }, {
                    "name": "Cruise",
                    "type": "string",
                    "comment": "Name of deployment cruise"
                  }]
                }, {
                  "name": "Platform",
                  "type": "string",
                  "comment": "On what platform is the instrument deployed? (e.g. mooring, tag)"
                }, {
                  "name": "Region",
                  "type": "string",
                  "comment": "Name of geographic Region"
                }, {
                  "name": "Instrument",
                  "comment": "Instrument type and identifier",
                  "children": [{
                    "name": "Type",
                    "type": "string",
                    "comment": "Instrument type, e.g. HARP, EAR, Popup, DMON, etc."
                  }, {
                    "name": "ID",
                    "type": "string",
                    "comment": "Instrument identifier, e.g. serial number"
                  }]
                }, {
                  "name": "Sampling Details",
                  "comment": "Information about recordings on each channel. Sample rate, quantization bits, etc.",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Channel",
                      "children": [{
                        "name": "Channel Number",
                        "type": "nonNegativeInteger",
                        "comment": "Channels and sensors are bound together from Start to End.  While not enforced, we assume channels are numbered from 1 to N."

                      }, {
                        "name": "Sensor Number",
                        "type": "int",
                        "comment": "Audio sensor index within Sensors element"
                      }, {
                        "name": "Start",
                        "type": "dateTime"

                      }, {
                        "name": "End",
                        "type": "dateTime"
                      }, {
                        "name": "Sampling",
                        "comment": "Sampling rate and quantization may change over time",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Regimen",
                            "comment": "Sampling regimen may change over time.  Each entry shows the start of a sampling configuration.",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Time Stamp",
                                "type": "dateTime"
                              }, {
                                "name": "Sample Rate_kHz",
                                "type": "double"
                              }, {
                                "name": "Sample Bits",
                                "type": "int"
                              }]
                            }]
                          }]
                        }]

                      }, {
                        "name": "Gain",
                        "comment": "Initial gain setting (assumed 0 if not populated) and any subsequent changes.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Regimen",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Time Stamp",
                                "type": "dateTime"
                              }, {
                                "name": "choice",
                                "children": [{
                                  "name": "Gain_dB",
                                  "type": "double"
                                }, {
                                  "name": "Gain_rel",
                                  "type": "double",
                                  "comment": "Only used if gain is not calibrated.  Relative gain may be a number on a dial."
                                }]
                              }]
                            }]
                          }]
                        }]

                      }, {
                        "name": "Duty Cycle",
                        "comment": "Duty cycle is represented by the recording duration and the interval from the start of one recording session to the next.  A duration of 3 m and an interval of 5 m would represent a 60% duty cycle, 3 m on, 2 m off.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Regimen",
                            "comment": "Duty cycling regimen may change over time.  Each entry shows the start of a duty cycle configuration.  The abscence of entries indicates continuous sampling as would having equal values in RecordingDuration_m and RecordingInterval_m.",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Time Stamp",
                                "type": "dateTime"
                              }, {
                                "name": "Recording Duration_m",
                                "type": "double"
                              }, {
                                "name": "Recording Interval_m",
                                "type": "double"
                              }]
                            }]
                          }]
                        }]

                      }]
                    }]
                  }]
                }, {
                  "name": "Quality Assurance",
                  "children": [{
                    "name": "Accoustic Data QA Type",
                    "children": [{
                      "name": "Quality Assurance Process Type (extension base)",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Description",
                          "children": [{
                            "name": "Description Type",
                            "comment": "Text based description of process",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Objectives",
                                "type": "string",
                                "comment": "What are the objectives of this effort?  Examples: Beamform to increase SNR for detection. Detect every click of a rare species. Verify data quality."
                              }, {
                                "name": "Abstract",
                                "type": "string",
                                "comment": "Overview of effort"
                              }, {
                                "name": "Method",
                                "type": "string",
                                "comment": "High-level description of the method used"
                              }]
                            }]

                          }]
                        }, {
                          "name": "Respomsible Party",
                          "comment": "based on ISO 19115",
                          "children": [{
                            "name": "Attributes",
                            "children": [{
                              "name": "id",
                              "type": "NCName",
                              "comment": "Handle to external database"
                            }]
                          }, {
                            "name": "Sequence",
                            "children": [{
                              "name": "Individual Name",
                              "type": "string"
                            }, {
                              "name": "Organization Name",
                              "type": "string"
                            }, {
                              "name": "Position Name",
                              "type": "string"
                            }, {
                              "name": "Contact Info",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Phone",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Voice",
                                      "type": "string"
                                    }, {
                                      "name": "Facsimile",
                                      "type": "string"
                                    }]
                                  }]
                                }, {
                                  "name": "Address",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Delivery Point",
                                      "type": "string"
                                    }, {
                                      "name": "City",
                                      "type": "string"
                                    }, {
                                      "name": "Administrative Area",
                                      "type": "string"
                                    }, {
                                      "name": "Postal Code",
                                      "type": "string"
                                    }, {
                                      "name": "Country",
                                      "type": "string"
                                    }, {
                                      "name": "Electronic Mail Address",
                                      "type": "string"
                                    }]
                                  }]
                                }, {
                                  "name": "Online Resource",
                                  "comment": "We do not fully conform to the onlineResources of ISO 19115",
                                  "children": [{
                                    "name": "Attributes",
                                    "children": [{
                                      "name": "##Any"
                                    }]
                                  }]
                                }, {
                                  "name": "Hours of Service",
                                  "type": "string"
                                }, {
                                  "name": "Contact Instructions",
                                  "type": "string"
                                }]
                              }]
                            }]
                          }]
                        }]
                      }]
                    }, {
                      "name": "Sequence",
                      "children": [{
                        "name": "Quality",
                        "comment": "If no quality assurance, create an entry of Category unverified spanning the acoustic record.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Start",
                            "type": "dateTime"
                          }, {
                            "name": "End",
                            "type": "dateTime",
                          }, {
                            "name": "Category",
                            "type": "string",
                            "comment": "categories: unverified, good, compromised, unusable"

                          }, {
                            "name": "Frequency Range",
                            "comment": "QA metric applies to what frequency range?",
                            "children": [{
                              "name": "Sequence",
                              "children": [{
                                "name": "Low_Hz",
                                "type": "double"
                              }, {
                                "name": "High_Hz",
                                "type": "double"
                              }]
                            }]
                          }, {
                            "name": "Channel",
                            "type": "integer"
                          }, {
                            "name": "Comment",
                            "type": "string",
                            "comment": "Additional qualitative information"

                          }]
                        }]
                      }]




                    }]
                  }]

                }, {
                  "name": "Data",
                  "comment": "Data from instrument, a URI is provided when not present (typical for audio).",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Audio",
                      "comment": "Information about audio data",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "URI",
                          "type": "string",
                          "comment": "Uniform Resource Indicator point to audio content."
                        }, {
                          "name": "Processed",
                          "type": "string",
                          "comment": "Pointer to location of data that has been processed (e.g. checked for quality, decimated, etc.)"
                        }, {
                          "name": "Raw",
                          "type": "string",
                          "comment": "Pointer to raw data from the instrument."
                        }]
                      }]
                    }, {
                      "name": "Track",
                      "comment": "A set of measurements about a ship/instrument's track line.",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Points",
                          "comment": "A set of sorted (by time) points associated with one or more tracklines.",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Trackline",
                              "type": "double",
                              "comment": "Optional trackline number.If unimportant,everything can be put in one Points element."
                            }, {
                              "name": "Point",
                              "comment": "Timestamped measurements:  long/lat, bearing, etc. Points should be sorted by timestamp.",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Time Stamp",
                                  "type": "dateTime"
                                }, {
                                  "name": "LongLat",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Longitube",
                                      "type": "double",
                                      "comment": "Expressed in degrees East [0, 360)"
                                    }, {
                                      "name": "Latitude",
                                      "type": "double",
                                      "comment": "Expressed in degrees North [-90, 90]"
                                    }]
                                  }],
                                  "comment": "Spherical reference system"
                                }, {
                                  "name": "Bearing DegN",
                                  "children": [{
                                    "name": "BearingDeg",
                                    "type": "Double"
                                  }, {
                                    "name": "Attributes",
                                    "type": "Restriction of xs:String(Default magnetic)"
                                  }],
                                  "comment": "Bearing in degrees [0, 360) relative to true or magnetic north (as specified by north attribute, default magnetic)"
                                }, {
                                  "name": "Speed_Kn",
                                  "type": "dobule",
                                  "comment": "Speed in knots"
                                }, {
                                  "name": "Pitch_deg",
                                  "type": "Restriction of double",
                                  "comment": "Instrument pitch [0, 360) degrees"
                                }, {
                                  "name": "Roll_deg",
                                  "type": "restriction of double",
                                  "comment": "Instrument roll [0, 360) degrees"
                                }, {
                                  "name": "Depth_m",
                                  "type": "double",
                                  "comment": "Instrument depth in meters"

                                }, {
                                  "name": "BottomDepth_m",
                                  "type": "double",
                                  "comment": "Bottom depth in meters"
                                }]
                              }]
                            }]
                          }]
                        }, {
                          "name": "Track Effort",
                          "comment": "Not all measurements are associated with an instrument/ship's planned trackline (e.g. when in chase mode or transiting between tracklines).  Specify times for track effort here if needed.",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "OnPath",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Path Element Type",
                                  "children": [{
                                    "name": "Trackline",
                                    "type": "double"
                                  }, {
                                    "name": "Start",
                                    "type": "dateTime"
                                  }, {
                                    "name": "End",
                                    "type": "dateTime"
                                  }, {
                                    "name": "Comment",
                                    "type": "string"
                                  }]
                                }]
                              }]
                            }, {
                              "name": "OffPath",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Path Element Type",
                                  "children": [{
                                    "name": "Trackline",
                                    "type": "double"
                                  }, {
                                    "name": "Start",
                                    "type": "dateTime"
                                  }, {
                                    "name": "End",
                                    "type": "dateTime"
                                  }, {
                                    "name": "Comment",
                                    "type": "string"
                                  }]
                                }]
                              }]
                            }]
                          }]
                        }, {
                          "name": "URI",
                          "comment": "Pointer to trackline information.",
                          "type": "string"
                        }]
                      }]
                    }]
                  }]
                }, {
                  "name": "Deployments Details",
                  "comemnt": "Instrument deployment location, time, etc.",
                  "children": [{
                    "name": "Deployment Recovery Details",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Long Lat",
                        "comment": "Spherical reference system",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Longitude",
                            "type": "double",
                            "comment": "Expressed in degrees East [0, 360)"
                          }, {
                            "name": "Latitude",
                            "type": "double",
                            "comment": "Expressed in degrees North [-90, 90]"
                          }]
                        }]
                      }, {
                        "name": "Depth Instrument_m",
                        "type": "double"
                      }, {
                        "name": "Depth Bottom_m",
                        "type": "double"
                      }, {
                        "name": "Time Stamp",
                        "type": "dateTime",
                        "comment": "Time at which instrument was deployed/recovered.Lost instruments: set recovery time to deployment time."
                      }, {
                        "name": "Audio Time Stamp",
                        "type": "dateTime",
                        "comment": "Recording start or end - May differ from deployment time."
                      }, {
                        "name": "Vessel",
                        "type": "string"
                      }, {
                        "name": "Contact Group",
                        "comment": "Contains a subset of the OpenGIS SensorML ContactGroup (http: //www.opengis.net/sensorML/1.0).  Parsing the full SensorML schema will slow down processing.",
                        "children": [{
                          "name": "Choice",
                          "children": [{
                            "name": "Person",
                            "children": [{
                              "name": "Attributes",
                              "children": [{
                                "name": "id",
                                "comment": "Handle to external database",
                                "type": "NCName"
                              }]
                            }, {
                              "name": "Sequence",
                              "children": [{
                                "name": "Surname",
                                "type": "token"
                              }, {
                                "name": "Name",
                                "type": "token"
                              }, {
                                "name": "UserID",
                                "type": "token"
                              }, {
                                "name": "Affiliation",
                                "type": "token"
                              }, {
                                "name": "Phone Number",
                                "type": "token"
                              }, {
                                "name": "Email",
                                "type": "token"
                              }]
                            }]
                          }, {
                            "name": "Responsible Party",
                            "comment": "based on ISO 19115",
                            "children": [{
                              "name": "Attribute",
                              "children": [{
                                "name": "id",
                                "comment": "Handle to external database",
                                "type": "NCName"
                              }]
                            }, {
                              "name": "Sequence",
                              "children": [{
                                  "name": "Individual Name",
                                  "type": "string"
                                }, {
                                  "name": "Organization Name",
                                  "type": "string"
                                }, {
                                  "name": "Position Name",
                                  "type": "string"
                                },
                                {
                                  "name": "Contact Info",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Phone",
                                      "children": [{
                                        "name": "Sequence",
                                        "children": [{
                                          "name": "Voice",
                                          "type": "string"
                                        }, {
                                          "name": "Facsimile",
                                          "type": "string"
                                        }]
                                      }]
                                    }, {
                                      "name": "Address",
                                      "children": [{
                                        "name": "Sequence",
                                        "children": [{
                                          "name": "Delivery Point",
                                          "type": "string"
                                        }, {
                                          "name": "City",
                                          "type": "string"
                                        }, {
                                          "name": "Administrative Area",
                                          "type": "string"
                                        }, {
                                          "name": "Postal Code",
                                          "type": "string"
                                        }, {
                                          "name": "Country",
                                          "type": "string"
                                        }, {
                                          "name": "Electronic Mail Address",
                                          "type": "string"
                                        }]
                                      }]
                                    }, {
                                      "name": "Online Resource",
                                      "comment": "We do not fully conform to the onlineResources of ISO 19115",
                                      "children": [{
                                        "name": "Attributes",
                                        "children": [{
                                          "name": "##Any"
                                        }]
                                      }]
                                    }, {
                                      "name": "Hours of Service",
                                      "type": "string"
                                    }, {
                                      "name": "Contact Instructions",
                                      "type": "string"
                                    }]
                                  }]

                                }
                              ]
                            }]
                          }]
                        }]
                      }]
                    }]
                  }]
                }, {
                  "name": "Recovery Details",
                  "comemnt": "Instrument recovery. location, time, etc.",
                  "children": [{
                    "name": "Deployment Recovery Details",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Long Lat",
                        "comment": "Spherical reference system",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Longitude",
                            "type": "double",
                            "comment": "Expressed in degrees East [0, 360)"
                          }, {
                            "name": "Latitude",
                            "type": "double",
                            "comment": "Expressed in degrees North [-90, 90]"
                          }]
                        }]
                      }, {
                        "name": "Depth Instrument_m",
                        "type": "double"
                      }, {
                        "name": "Depth Bottom_m",
                        "type": "double"
                      }, {
                        "name": "Time Stamp",
                        "type": "dateTime",
                        "comment": "Time at which instrument was deployed/recovered.Lost instruments: set recovery time to deployment time."
                      }, {
                        "name": "Audio Time Stamp",
                        "type": "dateTime",
                        "comment": "Recording start or end - May differ from deployment time."
                      }, {
                        "name": "Vessel",
                        "type": "string"
                      }, {
                        "name": "Contact Group",
                        "comment": "Contains a subset of the OpenGIS SensorML ContactGroup (http: //www.opengis.net/sensorML/1.0).  Parsing the full SensorML schema will slow down processing.",
                        "children": [{
                          "name": "Choice",
                          "children": [{
                            "name": "Person",
                            "children": [{
                              "name": "Attributes",
                              "children": [{
                                "name": "id",
                                "comment": "Handle to external database",
                                "type": "NCName"
                              }]
                            }, {
                              "name": "Sequence",
                              "children": [{
                                "name": "Surname",
                                "type": "token"
                              }, {
                                "name": "Name",
                                "type": "token"
                              }, {
                                "name": "UserID",
                                "type": "token"
                              }, {
                                "name": "Affiliation",
                                "type": "token"
                              }, {
                                "name": "Phone Number",
                                "type": "token"
                              }, {
                                "name": "Email",
                                "type": "token"
                              }]
                            }]
                          }, {
                            "name": "Responsible Party",
                            "comment": "based on ISO 19115",
                            "children": [{
                              "name": "Attribute",
                              "children": [{
                                "name": "id",
                                "comment": "Handle to external database",
                                "type": "NCName"
                              }]
                            }, {
                              "name": "Sequence",
                              "children": [{
                                  "name": "Individual Name",
                                  "type": "string"
                                }, {
                                  "name": "Organization Name",
                                  "type": "string"
                                }, {
                                  "name": "Position Name",
                                  "type": "string"
                                },
                                {
                                  "name": "Contact Info",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Phone",
                                      "children": [{
                                        "name": "Sequence",
                                        "children": [{
                                          "name": "Voice",
                                          "type": "string"
                                        }, {
                                          "name": "Facsimile",
                                          "type": "string"
                                        }]
                                      }]
                                    }, {
                                      "name": "Address",
                                      "children": [{
                                        "name": "Sequence",
                                        "children": [{
                                          "name": "Delivery Point",
                                          "type": "string"
                                        }, {
                                          "name": "City",
                                          "type": "string"
                                        }, {
                                          "name": "Administrative Area",
                                          "type": "string"
                                        }, {
                                          "name": "Postal Code",
                                          "type": "string"
                                        }, {
                                          "name": "Country",
                                          "type": "string"
                                        }, {
                                          "name": "Electronic Mail Address",
                                          "type": "string"
                                        }]
                                      }]
                                    }, {
                                      "name": "Online Resource",
                                      "comment": "We do not fully conform to the onlineResources of ISO 19115",
                                      "children": [{
                                        "name": "Attributes",
                                        "children": [{
                                          "name": "##Any"
                                        }]
                                      }]
                                    }, {
                                      "name": "Hours of Service",
                                      "type": "string"
                                    }, {
                                      "name": "Contact Instructions",
                                      "type": "string"
                                    }]
                                  }]

                                }
                              ]
                            }]
                          }]
                        }]
                      }]
                    }]
                  }]
                }, {
                  "name": "Sensors_____",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Audio",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Generic Sensor",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Number",
                              "type": "integer"
                            }, {
                              "name": "SensorID",
                              "type": "string"
                            }, {
                              "name": "Geomtry",
                              "comment": "Geometry relative to platform",
                              "children": [{
                                "name": "Choice",
                                "children": [{
                                  "name": "x_m",
                                  "type": "double"
                                }, {
                                  "name": "y_m",
                                  "type": "double"
                                }, {
                                  "name": "z_m",
                                  "type": "double"
                                }]
                              }]
                            }, {
                              "name": "Name",
                              "comment": "Optional sensor name",
                              "type": "string"
                            }, {
                              "name": "Description",
                              "comment": "Optional description of sensor",
                              "type": "string"
                            }]
                          }]
                        }, {
                          "name": "Sequence",
                          "children": [{
                            "name": "HydrophoneID",
                            "type": "string"
                          }, {
                            "name": "PreampID",
                            "type": "string"
                          }]
                        }]
                      }]
                    }, {
                      "name": "Depth",
                      "children": [{
                        "name": "Generic Sensor",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Number",
                            "type": "integer"
                          }, {
                            "name": "SensorID",
                            "type": "string"
                          }, {
                            "name": "Geomtry",
                            "comment": "Geometry relative to platform",
                            "children": [{
                              "name": "Choice",
                              "children": [{
                                "name": "x_m",
                                "type": "double"
                              }, {
                                "name": "y_m",
                                "type": "double"
                              }, {
                                "name": "z_m",
                                "type": "double"
                              }]
                            }]
                          }, {
                            "name": "Name",
                            "comment": "Optional sensor name",
                            "type": "string"
                          }, {
                            "name": "Description",
                            "comment": "Optional description of sensor",
                            "type": "string"
                          }]
                        }]
                      }]
                    }, {
                      "name": "Sensor",
                      "children": [{
                        "name": "Sequence",
                        "children": [{
                          "name": "Generic Sensor",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Number",
                              "type": "integer"
                            }, {
                              "name": "SensorID",
                              "type": "string"
                            }, {
                              "name": "Geomtry",
                              "comment": "Geometry relative to platform",
                              "children": [{
                                "name": "Choice",
                                "children": [{
                                  "name": "x_m",
                                  "type": "double"
                                }, {
                                  "name": "y_m",
                                  "type": "double"
                                }, {
                                  "name": "z_m",
                                  "type": "double"
                                }]
                              }]
                            }, {
                              "name": "Name",
                              "comment": "Optional sensor name",
                              "type": "string"
                            }, {
                              "name": "Description",
                              "comment": "Optional description of sensor",
                              "type": "string"
                            }]
                          }]
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                          "name": "Type",
                          "type": "string"
                        }, {
                          "name": "Properties",
                          "type": "##any"
                        }]
                      }]
                    }]
                  }]

                }]
              }, {
                "name": "Constraints",
                "children": [{
                  "name": "Deployment Key",
                  "children": [{
                    "name": "Selector",
                  }, {
                    "name": "Project"
                  }, {
                    "name": "DeploymentID"
                  }, {
                    "name": "Cite"
                  }, {
                    "name": "Cruise"
                  }]
                }]

              }]
            },
            {
              "name": "Generic Sensor",
              "children": [{
                "name": "Sequence",
                "children": [{
                  "name": "Number",
                  "type": "integer"
                }, {
                  "name": "SensorID",
                  "type": "string"
                }, {
                  "name": "Geomtry",
                  "children": [{
                    "name": "Choice",
                    "children": [{
                      "name": "x_m",
                      "type": "double"
                    }, {
                      "name": "y_m",
                      "type": "double"
                    }, {
                      "name": "z_m",
                      "type": "double"
                    }]
                  }]
                }, {
                  "name": "Name",
                  "type": "string"
                }, {
                  "name": "Description",
                  "type": "string"
                }]
              }]
            },
            {
              "name": "Unknown Sensor",
              "children": [{
                "name": "Generic Sensor",
                "children": [{
                  "name": "Sequence",
                  "children": [{
                    "name": "Number",
                    "type": "integer"
                  }, {
                    "name": "SensorID",
                    "type": "string"
                  }, {
                    "name": "Geomtry",
                    "children": [{
                      "name": "Choice",
                      "children": [{
                        "name": "x_m",
                        "type": "double"
                      }, {
                        "name": "y_m",
                        "type": "double"
                      }, {
                        "name": "z_m",
                        "type": "double"
                      }]
                    }]
                  }, {
                    "name": "Name",
                    "type": "string"
                  }, {
                    "name": "Description",
                    "type": "string"
                  }]
                }]
              }, {
                "name": "Sequence",
                "children": [{
                  "name": "Type",
                  "type": "string"
                }, {
                  "name": "Properties",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "##any"
                    }]
                  }]
                }]
              }]
            },
            {
              "name": "Audio",
              "children": [{
                "name": "Generic Sensor",
                "children": [{
                  "name": "Sequence",
                  "children": [{
                    "name": "Number",
                    "type": "integer"
                  }, {
                    "name": "SensorID",
                    "type": "string"
                  }, {
                    "name": "Geomtry",
                    "children": [{
                      "name": "Choice",
                      "children": [{
                        "name": "x_m",
                        "type": "double"
                      }, {
                        "name": "y_m",
                        "type": "double"
                      }, {
                        "name": "z_m",
                        "type": "double"
                      }]
                    }]
                  }, {
                    "name": "Name",
                    "type": "string"
                  }, {
                    "name": "Description",
                    "type": "string"
                  }]
                }]
              }, {
                "name": "Sequence",
                "children": [{
                  "name": "HydrophoneID",
                  "type": "string"
                }, {
                  "name": "PreampID",
                  "type": "string"
                }]
              }]
            }, {
              "name": "Channel Info",
              "children": [{
                "name": "Sequence",
                "children": [{
                  "name": "Channel",
                  "children": [{
                    "name": "Channel Number",
                    "type": "nonNegativeInteger",
                    "comment": "Channels and sensors are bound together from Start to End.  While not enforced, we assume channels are numbered from 1 to N."
                  }, {
                    "name": "Sensor Number",
                    "type": "int",
                    "comment": "Audio sensor index within Sensors element"
                  }, {
                    "name": "Start",
                    "type": "dateTime"

                  }, {
                    "name": "End",
                    "type": "dateTime"
                  }, {
                    "name": "Sampling",
                    "comment": "Sampling rate and quantization may change over time",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Regimen",
                        "comment": "Sampling regimen may change over time.  Each entry shows the start of a sampling configuration.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Time Stamp",
                            "type": "dateTime"
                          }, {
                            "name": "Sample Rate_kHz",
                            "type": "double"
                          }, {
                            "name": "Sample Bits",
                            "type": "int"
                          }]
                        }]
                      }]
                    }]
                  }, {
                    "name": "Gain",
                    "comment": "Initial gain setting (assumed 0 if not populated) and any subsequent changes.",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Regimen",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Time Stamp",
                            "type": "dateTime"
                          }, {
                            "name": "choice",
                            "children": [{
                              "name": "Gain_dB",
                              "type": "double"
                            }, {
                              "name": "Gain_rel",
                              "type": "double",
                              "comment": "Only used if gain is not calibrated.  Relative gain may be a number on a dial."
                            }]
                          }]
                        }]
                      }]
                    }]

                  }, {
                    "name": "Duty Cycle",
                    "comment": "Duty cycle is represented by the recording duration and the interval from the start of one recording session to the next.  A duration of 3 m and an interval of 5 m would represent a 60% duty cycle, 3 m on, 2 m off.",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Regimen",
                        "comment": "Duty cycling regimen may change over time.  Each entry shows the start of a duty cycle configuration.  The abscence of entries indicates continuous sampling as would having equal values in RecordingDuration_m and RecordingInterval_m.",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Time Stamp",
                            "type": "dateTime"
                          }, {
                            "name": "Recording Duration_m",
                            "type": "double"
                          }, {
                            "name": "Recording Interval_m",
                            "type": "double"
                          }]
                        }]
                      }]
                    }]

                  }]
                }]
              }]

            },
            {
              "name": "Deployment Recovery Details",
              "children": [{
                "name": "Deployment Recovery Details",
                "children": [{
                  "name": "Sequence",
                  "children": [{
                    "name": "Long Lat",
                    "comment": "Spherical reference system",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Longitude",
                        "type": "double",
                        "comment": "Expressed in degrees East [0, 360)"
                      }, {
                        "name": "Latitude",
                        "type": "double",
                        "comment": "Expressed in degrees North [-90, 90]"
                      }]
                    }]
                  }, {
                    "name": "Depth Instrument_m",
                    "type": "double"
                  }, {
                    "name": "Depth Bottom_m",
                    "type": "double"
                  }, {
                    "name": "Time Stamp",
                    "type": "dateTime",
                    "comment": "Time at which instrument was deployed/recovered.Lost instruments: set recovery time to deployment time."
                  }, {
                    "name": "Audio Time Stamp",
                    "type": "dateTime",
                    "comment": "Recording start or end - May differ from deployment time."
                  }, {
                    "name": "Vessel",
                    "type": "string"
                  }, {
                    "name": "Contact Group",
                    "comment": "Contains a subset of the OpenGIS SensorML ContactGroup (http: //www.opengis.net/sensorML/1.0).  Parsing the full SensorML schema will slow down processing.",
                    "children": [{
                      "name": "Choice",
                      "children": [{
                        "name": "Person",
                        "children": [{
                          "name": "Attributes",
                          "children": [{
                            "name": "id",
                            "comment": "Handle to external database",
                            "type": "NCName"
                          }]
                        }, {
                          "name": "Sequence",
                          "children": [{
                            "name": "Surname",
                            "type": "token"
                          }, {
                            "name": "Name",
                            "type": "token"
                          }, {
                            "name": "UserID",
                            "type": "token"
                          }, {
                            "name": "Affiliation",
                            "type": "token"
                          }, {
                            "name": "Phone Number",
                            "type": "token"
                          }, {
                            "name": "Email",
                            "type": "token"
                          }]
                        }]
                      }, {
                        "name": "Responsible Party",
                        "comment": "based on ISO 19115",
                        "children": [{
                          "name": "Attribute",
                          "children": [{
                            "name": "id",
                            "comment": "Handle to external database",
                            "type": "NCName"
                          }]
                        }, {
                          "name": "Sequence",
                          "children": [{
                              "name": "Individual Name",
                              "type": "string"
                            }, {
                              "name": "Organization Name",
                              "type": "string"
                            }, {
                              "name": "Position Name",
                              "type": "string"
                            },
                            {
                              "name": "Contact Info",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Phone",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Voice",
                                      "type": "string"
                                    }, {
                                      "name": "Facsimile",
                                      "type": "string"
                                    }]
                                  }]
                                }, {
                                  "name": "Address",
                                  "children": [{
                                    "name": "Sequence",
                                    "children": [{
                                      "name": "Delivery Point",
                                      "type": "string"
                                    }, {
                                      "name": "City",
                                      "type": "string"
                                    }, {
                                      "name": "Administrative Area",
                                      "type": "string"
                                    }, {
                                      "name": "Postal Code",
                                      "type": "string"
                                    }, {
                                      "name": "Country",
                                      "type": "string"
                                    }, {
                                      "name": "Electronic Mail Address",
                                      "type": "string"
                                    }]
                                  }]
                                }, {
                                  "name": "Online Resource",
                                  "comment": "We do not fully conform to the onlineResources of ISO 19115",
                                  "children": [{
                                    "name": "Attributes",
                                    "children": [{
                                      "name": "##Any"
                                    }]
                                  }]
                                }, {
                                  "name": "Hours of Service",
                                  "type": "string"
                                }, {
                                  "name": "Contact Instructions",
                                  "type": "string"
                                }]
                              }]

                            }
                          ]
                        }]
                      }]
                    }]
                  }]
                }]
              }]
            },
            {
              "name": "Accoustic Data QA Type",
              "children": [{
                "name": "Accoustic Data QA Type",
                "children": [{
                  "name": "Quality Assurance Process Type (extension base)",
                  "children": [{
                    "name": "Sequence",
                    "children": [{
                      "name": "Description",
                      "children": [{
                        "name": "Description Type",
                        "comment": "Text based description of process",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Objectives",
                            "type": "string",
                            "comment": "What are the objectives of this effort?  Examples: Beamform to increase SNR for detection. Detect every click of a rare species. Verify data quality."
                          }, {
                            "name": "Abstract",
                            "type": "string",
                            "comment": "Overview of effort"
                          }, {
                            "name": "Method",
                            "type": "string",
                            "comment": "High-level description of the method used"
                          }]
                        }]

                      }]
                    }, {
                      "name": "Respomsible Party",
                      "comment": "based on ISO 19115",
                      "children": [{
                        "name": "Attributes",
                        "children": [{
                          "name": "id",
                          "type": "NCName",
                          "comment": "Handle to external database"
                        }]
                      }, {
                        "name": "Sequence",
                        "children": [{
                          "name": "Individual Name",
                          "type": "string"
                        }, {
                          "name": "Organization Name",
                          "type": "string"
                        }, {
                          "name": "Position Name",
                          "type": "string"
                        }, {
                          "name": "Contact Info",
                          "children": [{
                            "name": "Sequence",
                            "children": [{
                              "name": "Phone",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Voice",
                                  "type": "string"
                                }, {
                                  "name": "Facsimile",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Address",
                              "children": [{
                                "name": "Sequence",
                                "children": [{
                                  "name": "Delivery Point",
                                  "type": "string"
                                }, {
                                  "name": "City",
                                  "type": "string"
                                }, {
                                  "name": "Administrative Area",
                                  "type": "string"
                                }, {
                                  "name": "Postal Code",
                                  "type": "string"
                                }, {
                                  "name": "Country",
                                  "type": "string"
                                }, {
                                  "name": "Electronic Mail Address",
                                  "type": "string"
                                }]
                              }]
                            }, {
                              "name": "Online Resource",
                              "comment": "We do not fully conform to the onlineResources of ISO 19115",
                              "children": [{
                                "name": "Attributes",
                                "children": [{
                                  "name": "##Any"
                                }]
                              }]
                            }, {
                              "name": "Hours of Service",
                              "type": "string"
                            }, {
                              "name": "Contact Instructions",
                              "type": "string"
                            }]
                          }]
                        }]
                      }]
                    }]
                  }]
                }, {
                  "name": "Sequence",
                  "children": [{
                    "name": "Quality",
                    "comment": "If no quality assurance, create an entry of Category unverified spanning the acoustic record.",
                    "children": [{
                      "name": "Sequence",
                      "children": [{
                        "name": "Start",
                        "type": "dateTime"
                      }, {
                        "name": "End",
                        "type": "dateTime",
                      }, {
                        "name": "Category",
                        "type": "string",
                        "comment": "categories: unverified, good, compromised, unusable"

                      }, {
                        "name": "Frequency Range",
                        "comment": "QA metric applies to what frequency range?",
                        "children": [{
                          "name": "Sequence",
                          "children": [{
                            "name": "Low_Hz",
                            "type": "double"
                          }, {
                            "name": "High_Hz",
                            "type": "double"
                          }]
                        }]
                      }, {
                        "name": "Channel",
                        "type": "integer"
                      }, {
                        "name": "Comment",
                        "type": "string",
                        "comment": "Additional qualitative information"
                      }]
                    }]
                  }]
                }]
              }]
            },
            {
              "name": "Path Element Type",
              "children": [{
                "name": "Path Element Type",
                "children": [{
                  "name": "Trackline",
                  "type": "double"
                }, {
                  "name": "Start",
                  "type": "dateTime"
                }, {
                  "name": "End",
                  "type": "dateTime"
                }, {
                  "name": "Comment",
                  "type": "string"
                }]
              }]
            }
          ]
        };






        var json3 = {
          "name": "3ShipOrder",
          "children": [{
              "name": "3Orderperson",
              "type": "3xs:string",
            },
            {
              "name": "333Shipto",
              "children": [{
                "name": "name",
                "type": "xs:string"
              }, {
                "name": "address",
                "type": "xs:string"
              }, {
                "name": "city",
                "type": "xs:string"
              }, {
                "name": "country",
                "type": "xs:string"
              }, ]
            },
            {
              "name": "item",
              "children": [{
                "name": "title",
                "type": "xs:string"
              }, {
                "name": "note",
                "type": "xs:string"
              }, {
                "name": "quanityt",
                "type": "xs:positiveInteger"
              }, {
                "name": "price",
                "type": "xs:decimal"
              }, ]
            },
            {
              "name": "orderid",
              "type": "xs:string"
            }
          ]
        };



        var margin = {
          top: 350,
          right: 50,
          bottom: 50,
          left: 150
        }
        var width = 700;
        var height = 650;
        var horizontalSeparationBetweenNodes = 0;
        var verticalSeparationBetweenNodes = 28;
        var maxLabel = 150;
        var duration = 500;
        var radius = 2;

        var i = 0;
        var root;



        //so the tree braches dont overlap
        var tree = d3.layout.tree()
          //.size([height, width])
          .nodeSize([30, ])
          .separation(function separation(a, b) {
            return a.parent == b.parent ? 2 : 1;
          });



        var diagonal = d3.svg.diagonal().projection(function(d) {
          return [d.y, d.x];
        });

        var svg = d3.select("#treeStructureBox").append("svg").attr("width", "100%").attr("height", "100%")
          .call(d3.behavior.zoom().on("zoom", function() { //zoom effect part and panning
            svg.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")")
          }))
          .append("g")
          .attr("transform", "translate(" + (margin.left + width / 4) + "," + margin.top + ")");;

        //??????????????????????????????????????????????????????????????
        if (Value == 1) {
          root = json1;
        } else if (Value == 2) {
          root = deployment;
        } else if (Value == 3) {
          root = json3;
        } else if (Value == 4) {
          root = json4;
        } else if (Value == 5) {
          root = json5;
        } else if (Value == 6) {
          root = json6;
        } else if (Value == 7) {
          root = json7;
        }

        //??????????????????????????????????????????????????????????????

        root.x0 = height / 2;
        root.y0 = 0;

        root.children.forEach(collapse);

        function update(source) {
          // Compute the new tree layout.
          var nodes = tree.nodes(root).reverse();
          var links = tree.links(nodes); // Normalize for fixed-depth.
          nodes.forEach(function(d) {
            d.y = d.depth * maxLabel;
          }); // Update the nodes
          var node = svg.selectAll("g.node").data(nodes, function(d) {
            return d.id || (d.id = ++i);
          }); // Enter any new nodes at the parent's previous position.
          var nodeEnter = node.enter().append("g").attr("class", "node").attr("transform", function(d) {
            return "translate(" + source.y0 + "," + source.x0 + ")";
          }).on("click", click);

          nodeEnter.append("circle").attr("r", 0).style("fill", function(d) {
            return d._children ? "green" : "white";
          });

          nodeEnter.append("text").attr("x", function(d) {
            var spacing = computeRadius(d) + 5;
            return d.children || d._children ? -spacing : spacing;
          }).attr("dy", "3").attr("text-anchor", function(d) {
            return d.children || d._children ? "end" : "start";
          }).text(function(d) {
            //if (d.type && d.comment) return d.name + " : " + d.type + " : " + d.comment;
            if (d.type) return d.name + " : " + d.type;
            //else if (d.comment) return d.name + " : " + d.comment;
            else return d.name;
          }).style("fill-opacity", 0); // Transition nodes to their new position.
          var nodeUpdate = node.transition().duration(duration).attr("transform", function(d) {
            return "translate(" + d.y + "," + d.x + ")";
          });

          nodeUpdate.select("circle").attr("r", function(d) {
            return computeRadius(d);
          }).style("fill", function(d) {
            return d._children ? "green" : "#fff";
          });

          nodeUpdate.select("text").style("fill-opacity", 1); // Transition exiting nodes to the parent's new position.
          var nodeExit = node.exit().transition().duration(duration).attr("transform", function(d) {
            return "translate(" + source.y + "," + source.x + ")";
          }).remove();

          nodeExit.select("circle").attr("r", 0);
          nodeExit.select("text").style("fill-opacity", 0); // Update the links
          var link = svg.selectAll("path.link").data(links, function(d) {
            return d.target.id;
          }); // Enter any new links at the parent's previous position.
          link.enter().insert("path", "g").attr("class", "link").attr("d", function(d) {
            var o = {
              x: source.x0,
              y: source.y0
            };
            return diagonal({
              source: o,
              target: o
            });
          }); // Transition links to their new position.
          link.transition().duration(duration).attr("d", diagonal); // Transition exiting nodes to the parent's new position.
          link.exit().transition().duration(duration).attr("d", function(d) {
            var o = {
              x: source.x,
              y: source.y
            };
            return diagonal({
              source: o,
              target: o
            });
          }).remove(); // Stash the old positions for transition.
          nodes.forEach(function(d) {
            d.x0 = d.x;
            d.y0 = d.y;
          });
        }

        function computeRadius(d) {
          if (d.children || d._children) return radius + (radius * nbEndNodes(d) / 10);
          else return radius;
        }

        function nbEndNodes(n) {
          nb = 0;
          if (n.children) {
            n.children.forEach(function(c) {
              nb += nbEndNodes(c);
            });
          } else if (n._children) {
            n._children.forEach(function(c) {
              nb += nbEndNodes(c);
            });
          } else nb++;

          return nb;
        }

        function click(d) {
          if (d.children) {
            d._children = d.children;
            d.children = null;
          } else {
            d.children = d._children;
            d._children = null;
          }
          update(d);
        }

        function collapse(d) {
          if (d.children) {
            d._children = d.children;
            d._children.forEach(collapse);
            d.children = null;
          }
        }
        update(root);
      }

      //D3 ends









      /*Open all nodes when Show all is clicked */




    }); //document.Ready




    //        var url = "http://localhost:9779/XQuery";
    //        var dataKey = 'XQuery';
    //        var dataValue = `(: import Tethys schema so we have type information about the docuements :)
    //import schema namespace ty="http://tethys.sdsu.edu/schema/1.0" at "tethys.xsd";
    //(: import utility functions :)
    //import module namespace lib="http://tethys.sdsu.edu/XQueryFns" at "Tethys.xq";
    //
    //
    //let $xmldocument := 0  (: first document :)
    //let $xmldocs := ()     (: no documents so far :)
    //
    //(: Find all of the desired detections.  
    //   This query is a bit more complicated than it need by as we are tracking
    //   which XML document the detections came from.  
    //
    //   This is sometimes useful, especially when there are multiple lines
    //   of effort across the same time and space, although it is not really 
    //   needed here.
    //
    //   We create a temporary variable with all of the detections and then sort them
    //   in the next query.  Again, this is overengineering for this specific query,
    //   but would be needed to return detections from multiple deployments in order.
    //:)
    //let $detections := for $item in (
    //    for $det at $p in collection("Detections")/ty:Detections
    //        let $xmldocument := $xmldocument + 1
    //        let $xmldocs := ($xmldocs, $det/DataSource)
    //        (: conditions on Detections group :)
    //        where upper-case($det/DataSource/Site) = upper-case("M") and 
    //              upper-case($det/DataSource/Project) = upper-case("SOCAL") and
    //              $det/DataSource/Deployment = 38.000000 
    //        return
    //           for $detection in $det/OnEffort/Detection  (: OnEffort/OffEffort :)
    //              (: conditions on individual Detections, here we use
    //                 an abbreviation for the species name  :)
    //              where $detection/SpeciesID = lib:abbrev2tsn("Zc", "NOAA.NMFS.v1") 
    //           return
    //                <Detection>
    //                  {$detection/Start}
    //                  {$detection/End}
    //                  <idx>{xs:integer($p)}</idx>
    //                </Detection>
    //        )
    //  return $item
    //
    //(: Sources contains the list of indices corresponding to all of the documents
    //   from which we drew detections :)
    //let $sources := distinct-values(for $d in $detections return $d/idx)
    //
    //(: Finally, we return the detections and a lsit of the data sources
    //   from which they came. :)
    //
    //return
    //<ty:Result xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    //<Detections>
    //  {(: Rewrite the detections mapping each detection to a deployment/ensemble :)
    //   for $d in $detections
    //   order by $d/Start
    //   return
    //     <Detection>
    //      {$d/Start}
    //      {$d/End}
    //      <idx>{index-of(($sources), $d/idx)}</idx>
    //     </Detection>
    //  }
    //</Detections>
    //<Sources>
    //  {
    //   (: Write out the information for the deployment/ensembles :)
    //   for $source in $sources
    //     return
    //      collection("Detections")[xs:decimal($source)]/ty:Detections/DataSource
    //  }
    //</Sources>
    //</ty:Result>`;
    //
    //
    //
    //
    //        var data = {"XQuery":dataValue};
    //        $.post(url, data, function(data){
    //            console.log(data);
    //          $('#info').html(data);  
    //        })

  </script>


</body>

</html>
